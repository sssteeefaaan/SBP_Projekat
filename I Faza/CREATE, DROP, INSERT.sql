--DROP
DROP TABLE ADMINISTRACIJA;
DROP TABLE DAN_POSETE;
DROP TABLE MOZE_DA_ANGAZUJE;
DROP TABLE ODGOVORNO_LICE;
DROP TABLE PERIOD_DANA;
DROP TABLE POSECUJE;
DROP TABLE PRESTUP;
DROP TABLE ZASTUPA;
DROP TABLE TERMIN_SETNJE;
DROP TABLE RADNIK_OBEZBEDJENJA;
DROP TABLE RADI_U;
DROP TABLE PSIHOLOG;
DROP TABLE ADVOKAT;
DROP TABLE FIRMA;
DROP TABLE IMAJU_KONTAKT;
DROP TABLE ZAPOSLENI;
DROP TABLE ZATVORENIK;
DROP TABLE CELIJSKI_PERIOD;
DROP TABLE ZATVORSKA_JEDINICA;


--CREATE
CREATE TABLE ZATVORSKA_JEDINICA(
SIFRA VARCHAR(5) PRIMARY KEY,
NAZIV VARCHAR(60) NOT NULL,
ADRESA VARCHAR(60) NOT NULL,
UPRAVNIK VARCHAR(30) NOT NULL,
KAPACITET INTEGER NOT NULL CHECK (KAPACITET > 0),
FREZIM_O VARCHAR(5) NOT NULL CHECK (FREZIM_O IN ('TRUE', 'FALSE')) ,
FREZIM_S VARCHAR(5) NOT NULL CHECK (FREZIM_S IN ('TRUE', 'FALSE')),
FREZIM_PO VARCHAR(5) NOT NULL CHECK (FREZIM_PO IN ('TRUE', 'FALSE'))
);

CREATE TABLE ZATVORENIK(
JMBG VARCHAR(13) PRIMARY KEY,
IME VARCHAR(25) NOT NULL,
PREZIME VARCHAR(25) NOT NULL,
POL VARCHAR(2) CHECK(POL IN ('M','Ž')) NOT NULL,
ADRESA VARCHAR(60),
BROJ VARCHAR(5) NOT NULL UNIQUE,
STATUS_USLOVNOG_OTPUSTA VARCHAR(11) CHECK( STATUS_USLOVNOG_OTPUSTA IN('PRIHVAĆEN', 'ODBIJEN', 'RAZMATRA SE')),
DATUM_SLEDECEG_SASLUSANJA DATE,
SIFRA_ZJ VARCHAR(5) REFERENCES ZATVORSKA_JEDINICA(SIFRA)
);

CREATE TABLE FIRMA(
PIB VARCHAR(9) PRIMARY KEY,
NAZIV VARCHAR(60) NOT NULL,
ADRESA VARCHAR(60) NOT NULL,
KONTAKT_TELEFON VARCHAR(15) NOT NULL
);

CREATE TABLE ADVOKAT( 
JMBG VARCHAR(13) PRIMARY KEY,
IME VARCHAR(25) NOT NULL,
PREZIME VARCHAR(25) NOT NULL,
POL VARCHAR(2) CHECK(POL IN ('M', 'Ž')) NOT NULL
);

CREATE TABLE ZAPOSLENI( 
JMBG VARCHAR(13) PRIMARY KEY,
IME VARCHAR(25) NOT NULL,
PREZIME VARCHAR(25) NOT NULL,
POL VARCHAR(2) CHECK(POL IN ('M', 'Ž')) NOT NULL,
RADNO_MESTO VARCHAR(60) NOT NULL,
DATUM_OBUKE_PPZ DATE NOT NULL
);

CREATE TABLE ADMINISTRACIJA(
JMBG_ZAP VARCHAR(13) NOT NULL,
ZANIMANJE VARCHAR(25),
POZICIJA VARCHAR(30),
STRUCNA_SPREMA VARCHAR(6),
CONSTRAINT ADMIN_PK PRIMARY KEY (JMBG_ZAP),
CONSTRAINT ADMIN_ZAP_FK FOREIGN KEY (JMBG_ZAP) REFERENCES ZAPOSLENI(JMBG)
ON DELETE CASCADE
);

CREATE TABLE IMAJU_KONTAKT(
JMBG_ZAP VARCHAR(13) NOT NULL,
LP_LEKAR VARCHAR(30) NOT NULL,
LP_DATUM DATE NOT NULL,
LP_NAZIV_USTANOVE VARCHAR(60) NOT NULL,
LP_ADRESA_USTANOVE VARCHAR(60) NOT NULL,
CONSTRAINT IMAJU_KONTAKT_PK PRIMARY KEY (JMBG_ZAP),
CONSTRAINT IMAJU_KONTAKT_FK FOREIGN KEY (JMBG_ZAP) REFERENCES ZAPOSLENI(JMBG)
ON DELETE CASCADE
);

CREATE TABLE PSIHOLOG(
JMBG_ZAP_KONT VARCHAR(13) NOT NULL,
S_SPECIJALIZACIJA VARCHAR(30) NOT NULL,
S_NAZIV_USTANOVE VARCHAR(60) NOT NULL,
CONSTRAINT PSIHOLOG_PK PRIMARY KEY (JMBG_ZAP_KONT),
CONSTRAINT PSIHOLOG_FK FOREIGN KEY (JMBG_ZAP_KONT) REFERENCES IMAJU_KONTAKT(JMBG_ZAP)
ON DELETE CASCADE
);

CREATE TABLE RADNIK_OBEZBEDJENJA(
JMBG_ZAP_KONT VARCHAR(13) NOT NULL,
DORVO_SIFRA VARCHAR(10) NOT NULL,
DORVO_POLICIJSKA_UPRAVA VARCHAR(60) NOT NULL,
DORVO_DATUM_IZDAVANJA DATE NOT NULL,
CONSTRAINT OBEZBEDJENJE_PK PRIMARY KEY (JMBG_ZAP_KONT),
CONSTRAINT OBEZ_IK_FK FOREIGN KEY (JMBG_ZAP_KONT) REFERENCES IMAJU_KONTAKT(JMBG_ZAP)
ON DELETE CASCADE
);

CREATE TABLE PRESTUP(
JMBG_ZAT VARCHAR(13) NOT NULL,
PUN_NAZIV VARCHAR(60) NOT NULL,
DATUM_PRESTUPA DATE NOT NULL,
MESTO_PRESTUPA VARCHAR(60) NOT NULL,
KATEGORIJA VARCHAR(30) NOT NULL,
OPIS VARCHAR(1024),
MIN_KAZNA_DANI INTEGER NOT NULL CHECK (MIN_KAZNA_DANI >= 0),
MAKS_KAZNA_DANI INTEGER NOT NULL CHECK (MAKS_KAZNA_DANI > 0),
CONSTRAINT PRESTUP_GRANICE CHECK (MIN_KAZNA_DANI <= MAKS_KAZNA_DANI),
CONSTRAINT PRESTUP_PK PRIMARY KEY (JMBG_ZAT, PUN_NAZIV, DATUM_PRESTUPA),
CONSTRAINT PRESTUP_ZAT_FK FOREIGN KEY (JMBG_ZAT) REFERENCES ZATVORENIK(JMBG)
ON DELETE CASCADE
);

CREATE TABLE RADI_U( 
SIFRA_ZJ VARCHAR(5) NOT NULL,
JMBG_ZAP VARCHAR(13) NOT NULL,
DATUM_POCETKA_RADA DATE NOT NULL,
CONSTRAINT RADI_U_PK PRIMARY KEY (SIFRA_ZJ, JMBG_ZAP),
CONSTRAINT  RADI_U_ZJ_FK FOREIGN KEY (SIFRA_ZJ) REFERENCES ZATVORSKA_JEDINICA(SIFRA)
ON DELETE CASCADE,
CONSTRAINT  RADI_U_ZAP_FK FOREIGN KEY (JMBG_ZAP) REFERENCES ZAPOSLENI(JMBG)
);

CREATE TABLE ZASTUPA(
JMBG_ZAT VARCHAR(13) NOT NULL,
JMBG_ADV VARCHAR(13) NOT NULL,
DATUM_POCETKA_SARADNJE DATE NOT NULL,
DATUM_POSLEDNJEG_KONTAKTA DATE,
CONSTRAINT ZASTUPA_PK PRIMARY KEY (JMBG_ZAT, JMBG_ADV),
CONSTRAINT ZASTUPA_ZAT_FK FOREIGN KEY (JMBG_ZAT) REFERENCES ZATVORENIK(JMBG)
ON DELETE CASCADE,
CONSTRAINT ZASTUPA_ADV_FK FOREIGN KEY (JMBG_ADV) REFERENCES ADVOKAT(JMBG)
ON DELETE CASCADE
);

CREATE TABLE POSECUJE(
JMBG_ZAT VARCHAR(13) NOT NULL,
JMBG_ADV VARCHAR(13) NOT NULL,
DT_POCETKA DATE NOT NULL,
DT_KRAJA DATE NOT NULL,
CONSTRAINT POSECUJE_DATUM CHECK (DT_POCETKA <= DT_KRAJA),
CONSTRAINT POSECUJE_PK PRIMARY KEY (JMBG_ZAT, JMBG_ADV),
CONSTRAINT POS_ZATV_FK FOREIGN KEY (JMBG_ZAT) REFERENCES ZATVORENIK(JMBG)
ON DELETE CASCADE,
CONSTRAINT POS_ADV_FK FOREIGN KEY (JMBG_ADV) REFERENCES ADVOKAT(JMBG)
);

CREATE TABLE MOZE_DA_ANGAZUJE(
PIB_FIRME VARCHAR(9) NOT NULL, 
SIFRA_ZJ VARCHAR(5) NOT NULL,
CONSTRAINT MDA_PK PRIMARY KEY (PIB_FIRME, SIFRA_ZJ),
CONSTRAINT MDA_FIRMA_FK FOREIGN KEY (PIB_FIRME) REFERENCES FIRMA(PIB)
ON DELETE CASCADE,
CONSTRAINT MDA_ZJ_FK FOREIGN KEY (SIFRA_ZJ) REFERENCES ZATVORSKA_JEDINICA(SIFRA)
ON DELETE CASCADE
);

CREATE TABLE TERMIN_SETNJE(
SIFRA_ZJ VARCHAR(5) NOT NULL,
TERMIN VARCHAR(10) NOT NULL,
CONSTRAINT TERMIN_SETNJE_PK PRIMARY KEY (SIFRA_ZJ, TERMIN),
CONSTRAINT TS_ZJ_FK FOREIGN KEY (SIFRA_ZJ) REFERENCES ZATVORSKA_JEDINICA(SIFRA)
ON DELETE CASCADE 
);

CREATE TABLE PERIOD_DANA(
SIFRA_ZJ VARCHAR(5) NOT NULL,
PERIOD VARCHAR(10) NOT NULL,
CONSTRAINT PERIOD_DANA_PK PRIMARY KEY (SIFRA_ZJ, PERIOD),
CONSTRAINT PD_ZJ_FK FOREIGN KEY (SIFRA_ZJ) REFERENCES ZATVORSKA_JEDINICA(SIFRA)
ON DELETE CASCADE
);

CREATE TABLE DAN_POSETE(
SIFRA_ZJ VARCHAR(5) NOT NULL,
DAN VARCHAR(10) CHECK (DAN IN ('PONEDELJAK', 'UTORAK','SREDA','ČETVRTAK','PETAK','SUBOTA','NEDELJA')) NOT NULL,
CONSTRAINT DAN_POSETE_PK PRIMARY KEY (SIFRA_ZJ, DAN),
CONSTRAINT DAN_POSETE_ZJ_FK FOREIGN KEY (SIFRA_ZJ) REFERENCES ZATVORSKA_JEDINICA(SIFRA)
ON DELETE CASCADE
);

CREATE TABLE CELIJSKI_PERIOD(
SIFRA_ZJ VARCHAR(5) NOT NULL,
PERIOD VARCHAR(10) NOT NULL,
CONSTRAINT CELIJSKI_PERIOD_PK PRIMARY KEY (SIFRA_ZJ, PERIOD),
CONSTRAINT CELIJSKI_PERIOD_ZJ_FK FOREIGN KEY (SIFRA_ZJ) REFERENCES ZATVORSKA_JEDINICA(SIFRA)
ON DELETE CASCADE
);

CREATE TABLE ODGOVORNO_LICE (
PIB_FIRME VARCHAR(9) NOT NULL,
PUNO_IME VARCHAR(40) NOT NULL,
CONSTRAINT ODG_LICE_PK PRIMARY KEY (PIB_FIRME, PUNO_IME),
CONSTRAINT ODG_LICE_FIRMA_FK FOREIGN KEY (PIB_FIRME) REFERENCES FIRMA(PIB)
);

--Zatvorske jedinice
INSERT INTO ZATVORSKA_JEDINICA VALUES('AAA21', 'Kazneno-popravni zavod "Padinska Skela"', 'Zrenjaninski put bb, 11200 Padinska Skela', 'Valentina Aleksić', 160, 'TRUE', 'FALSE', 'FALSE');
INSERT INTO ZATVORSKA_JEDINICA VALUES('AAB21', 'Kazneno-popravni zavod "Zabeli"', 'Zabela bb, 12102 Požarevac', 'Milutin Milanković', 1300, 'TRUE', 'FALSE', 'TRUE');
INSERT INTO ZATVORSKA_JEDINICA VALUES('AAC21', 'Okružni zatvor Novi Sad', 'Proleterska 16a, 21000 Novi Sad', 'Goran Jovanović', 304, 'FALSE', 'TRUE', 'FALSE');
INSERT INTO ZATVORSKA_JEDINICA VALUES('AAD21', 'Okružni zatvor Čačak', 'Cara Dušana bb, 32000 Čačak', 'Jovanka Orleanka', 110, 'FALSE', 'FALSE', 'TRUE');

--Zatvorenici
--AAA21
INSERT INTO ZATVORENIK VALUES ('0203995750023', 'Stojan', 'Džehverović', 'M', 'Skadarska 40c1, 11000 Beograd', '16989', 'RAZMATRA SE', '06-JUN-21', 'AAA21');
INSERT INTO ZATVORENIK VALUES ('1407988752119', 'Sloba', 'Radanović', 'M', 'Ulica Narodne omladine, Zrenjanin, 11000 Beograd', '15989', 'RAZMATRA SE', '12-FEB-22', 'AAA21');
INSERT INTO ZATVORENIK VALUES ('1302000750023', 'Vuk', 'Bibić', 'M', 'Nikole Pašića 13, 18000 Niš', '17015', 'RAZMATRA SE', '06-JUN-21', 'AAA21');
INSERT INTO ZATVORENIK VALUES ('1107999759131', 'Strahinja', 'Stamenković', 'M', 'Gavrila Principa 31, 16210 Vlasotince', '17413', 'PRIHVAĆEN', '16-JUN-21', 'AAA21');

--AAA21
INSERT INTO ZATVORENIK VALUES ('2011956748912', 'Aneta', 'Simić', 'Ž', 'Besna kobila bb, 17500 Vranje', 'UZ789', 'RAZMATRA SE', '15-DEC-25', 'AAB21');
INSERT INTO ZATVORENIK VALUES('1208999759118', 'Kristina', 'Stanojević', 'Ž', 'Džervinska 36, 19350 Knjaževac', 'A37HZ', 'RAZMATRA SE', '12-AUG-21', 'AAB21');
INSERT INTO ZATVORENIK VALUES('1305993741118', 'Petra', 'Marković', 'Ž', 'Vizantijski bulevar 5, 18000 Niš', 'JT9Z2', 'ODBIJEN', '13-MAR-23', 'AAB21');
INSERT INTO ZATVORENIK VALUES('0209997591541', 'Sofija', 'Stojanović', 'Ž', 'Karađorđeva 109, 17510 Vladičin Han',  'I38MZ', 'RAZMATRA SE', '10-OCT-21', 'AAB21');
INSERT INTO ZATVORENIK VALUES('1708978732323', 'Jelena', 'Karleuša', 'Ž', 'Oračka - Zemun, 11000 Beograd',  'JK8JK', 'ODBIJEN', '17-DEC-24', 'AAB21');

--AAA21
INSERT INTO ZATVORENIK VALUES('1607997742023', 'Darko', 'Stošić', 'M', 'Rasadnik 2/5, 18000 Niš', 'T1NA3', 'PRIHVAĆEN', '23-JAN-21', 'AAC21');
INSERT INTO ZATVORENIK VALUES('2302983773221', 'Milan', 'Ranković', 'M', 'Miroslava Antića, 24000 Subotica', 'K01H2', 'RAZMATRA SE', '18-SEP-22', 'AAC21');
INSERT INTO ZATVORENIK VALUES('1809987654126', 'Dušan', 'Nikolić', 'M', 'Anke Frank - Palilula, 11000 Beograd',  'TH98L', 'PRIHVAĆEN', '01-JUN-23', 'AAC21');
INSERT INTO ZATVORENIK VALUES('0101967554919', 'Osman', 'Agić', 'M', NULL,  'OA20G', 'ODBIJEN', NULL, 'AAC21');
INSERT INTO ZATVORENIK VALUES('0903966759113', 'Jovan', 'Popović', 'M', 'Nikole Tesle 9, 26000 Pančevo', 'TP27L', 'RAZMATRA SE', '09-AUG-23', 'AAC21');

--AAA21
INSERT INTO ZATVORENIK VALUES ('0203000750024', 'Stefan', 'Aleksić', 'M', 'Gornje Zuniče bb, 19350 Knjaževac', '16995', 'PRIHVAĆEN', '02-MAR-22', 'AAD21');
INSERT INTO ZATVORENIK VALUES ('2406999750024', 'Kosta', 'Rakić', 'M', '9. Avgust 12, 19350 Knjaževac', '18666', 'ODBIJEN', '24-JUN-21', 'AAD21'); 
INSERT INTO ZATVORENIK VALUES ('0606999750012', 'Luka', 'Obradović', 'M', 'Romanijska 23, 18000 Niš', '95669', 'ODBIJEN', '06-JUN-21', 'AAD21'); 
INSERT INTO ZATVORENIK VALUES ('0505945748024', 'Dobrivoje', 'Pasulj', 'M', 'Kromanjonska 14, 11000 Beograd', '76432', 'RAZMATRA SE', '22-OCT-21', 'AAD21'); 
INSERT INTO ZATVORENIK VALUES ('1909999738712', 'Nikola', 'Petrović', 'M', 'Grdelica bb, 16220 Leskovac', '17344', 'PRIHVAĆEN', '05-SEP-21', 'AAD21');

--FIRME
INSERT INTO FIRMA VALUES('100234131', 'Krojačka radionica "PECA"', 'Dunavska 31, 11000 Beograd', '0638225611');
INSERT INTO FIRMA VALUES('102131525', 'Vulkanizer "GAGI"', 'Nikole Pašića, 18000 Niš', '0611765413');
INSERT INTO FIRMA VALUES ('109865782', 'Bravar "ZOKI"', 'Osamnaesti jul 12, 32000 Čačak', '0633765721');

--ADVOKATI
INSERT INTO ADVOKAT VALUES('2109978665119', 'Aleksandar', 'Gavrilović', 'M');
INSERT INTO ADVOKAT VALUES('1204964525465', 'Milena', 'Kostić', 'Ž');
INSERT INTO ADVOKAT VALUES('3104988756441', 'Slaviša', 'Stepić', 'M');
INSERT INTO ADVOKAT VALUES('0303989323255', 'Katarina', 'Stefanović', 'Ž');
INSERT INTO ADVOKAT VALUES('2103131432452', 'Istok', 'Nikić', 'M');
INSERT INTO ADVOKAT VALUES('1209972431232', 'Kristijan', 'Antonijević', 'M');
INSERT INTO ADVOKAT VALUES('0906967212124', 'Ognjenka', 'Lilić', 'Ž');
INSERT INTO ADVOKAT VALUES('1911988765213', 'Dragutin', 'Simov', 'M');

--Zaposleni
INSERT INTO ZAPOSLENI VALUES('1212976313145', 'Nenad', 'Nenković', 'M', 'ŠTA IDE OVDE', '13-MAY-21');
INSERT INTO ZAPOSLENI VALUES('2209999759711', 'Miljana', 'Simić', 'Ž', 'ŠTA IDE OVDE', '03-DEC-20');
INSERT INTO ZAPOSLENI VALUES('0904999756138', 'Uroš', 'Pešić', 'M', 'ŠTA IDE OVDE', '03-DEC-20');
INSERT INTO ZAPOSLENI VALUES('1609988728807', 'Lav', 'Srećković', 'M', 'ŠTA IDE OVDE', '04-APRIL-21');

INSERT INTO ZAPOSLENI VALUES('0509997654312', 'Jelica', 'Janić', 'Ž', 'ŠTA IDE OVDE', '03-MAR-21');
INSERT INTO ZAPOSLENI VALUES('0708983834772', 'Svetozar', 'Vučković', 'M', 'ŠTA IDE OVDE', '29-SEP-20');
INSERT INTO ZAPOSLENI VALUES('1509874334210', 'Danica', 'Đorđević', 'Ž', 'ŠTA IDE OVDE', '10-AUG-21');
INSERT INTO ZAPOSLENI VALUES('0107985432341', 'Eleonora', 'Pantić', 'Ž', 'ŠTA IDE OVDE', '27-FEB-21');

INSERT INTO ZAPOSLENI VALUES('0609974432621', 'Nikola', 'Anđelić', 'M', 'ŠTA IDE OVDE', '19-JUL-21');
INSERT INTO ZAPOSLENI VALUES('2607982273190', 'Branko', 'Ranković', 'M', 'ŠTA IDE OVDE', '13-JAN-21');
INSERT INTO ZAPOSLENI VALUES('2807978458721', 'Dušica', 'Aleksić', 'Ž', 'ŠTA IDE OVDE', '28-OCT-20');
INSERT INTO ZAPOSLENI VALUES('2906974739042', 'Njegoš', 'Harambaša', 'M', 'ŠTA IDE OVDE', '09-OCT-20');
INSERT INTO ZAPOSLENI VALUES('1312989432832', 'Pavle', 'Stojkovič', 'M', 'ŠTA IDE OVDE', '28-OCT-20');
INSERT INTO ZAPOSLENI VALUES('1310967623160', 'Kristijan', 'Nedeljković', 'M', 'ŠTA IDE OVDE', '13-SEP-20');
INSERT INTO ZAPOSLENI VALUES('2712991342432', 'Pavle', 'Stojkovič', 'M', 'ŠTA IDE OVDE', '12-AUG-20');
INSERT INTO ZAPOSLENI VALUES('0808978432562', 'Robert', 'Stojković', 'M', 'ŠTA IDE OVDE', '01-FEB-21');